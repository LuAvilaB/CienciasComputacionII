<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hash - Doble Hash</title>
    <link rel="icon"
    href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Escudo_UD.svg/248px-Escudo_UD.svg.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../estilos/general.css">
    <script  src="../funciones/hash.js"></script>
    <script  src="../funciones/hashtable.js"></script>
    <script src="../funciones/control_hash_doble.js"></script>
    <style>
        .metrics-container {
            background-color: #f0f0f0;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        .metric-item {
            background-color: white;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }
        .metric-item strong {
            color: #0066cc;
            display: block;
            margin-bottom: 5px;
        }
        #avisos {
            white-space: pre-line;
        }
    </style>

</head>
<body>
    
    <div class="cabecera">
     <h1>Hash con Doble Dispersi칩n</h1>
    <button onclick="handleSave()">游 Guardar</button>
    <button onclick="handleLoad()">游늭 Recuperar</button>
    <button><a href="funciones_hash.html">Regresar</a></button>   
    </div>
    
    <div class="divisor">
        <div class="divisor-elem" style="flex: 30%;">
            <h2>Operaciones</h2>
            <div class="contenedor operacion">
                <h3>Iniciar estructura</h3>
                <label for="i-n">Tama침o inicial: </label>
                <input class="i-numero" id="i-n" type="number" placeholder="Ej: 11" value="11">
                <br><br>
                <label for="i-tam-clave">Tama침o de clave: </label>
                <input class="i-numero" id="i-tam-clave" type="number" placeholder="D칤gitos de la clave" value="2">
                <br><br>
                <label for="i-max-load">Umbral expansi칩n (풤): </label>
                <input class="i-numero" id="i-max-load" type="number" step="0.01" min="0.1" max="1" placeholder="0.7" value="0.7" style="width: 80px;">
                <br><br>
                <label for="i-min-load">Umbral reducci칩n (풤): </label>
                <input class="i-numero" id="i-min-load" type="number" step="0.01" min="0" max="0.9" placeholder="0.25" value="0.25" style="width: 80px;">
                <br><br>
                <label for="cb-auto-reduce">
                    <input type="checkbox" id="cb-auto-reduce">
                    Activar reducciones autom치ticas
                </label>
                <br><br>
                <button id="btn-iniciar-arr">Iniciar</button>
                <br>
            </div>
            <div class="contenedor operacion">
                <h3>Operaciones con claves</h3>
                <label for="hash-opt">Funci칩n Hash Principal: </label>
                <select id="hash-opt" style="width: 179px;">
                    <option value="1">M칩dulo</option>
                    <option value="2">Cuadrado</option>
                    <option value="3">Plegamiento</option>
                    <option value="4">Truncamiento</option>
                </select>
                <br><br>
                <label for="i-ach">Clave: </label>
                <input class="i-numero" id="i-ach" type="number" placeholder="Ingrese la clave">
                <br><br>
                <button id="btn-agrega-clave-hash">Agregar</button>
                <button id="btn-buscar-clave-hash">Buscar</button>
                <button id="btn-eliminar-clave-hash">Eliminar</button>
                <br><br>
                <div style="font-size: 0.9em; color: #666; line-height: 1.4;">
                    <strong>Nota:</strong> Esta implementaci칩n usa:
                    <ul style="margin: 5px 0; padding-left: 20px;">
                        <li>Doble hash para resolver colisiones</li>
                        <li>Umbrales de expansi칩n/reducci칩n definidos por el usuario</li>
                        <li>Reducciones solo si est치n activadas (evita ciclos infinitos)</li>
                        <li>칈ndices base 0 (sin +1)</li>
                    </ul>
                </div>
            </div>
            
        </div>
        <div class="divisor-elem" style="flex: 70%;">
            <h2>M칠tricas de la Tabla Hash</h2>
            <div id="metrics">
                <p style="color: #666;">Inicialice la estructura para ver las m칠tricas</p>
            </div>
            
            <h2>Estructura</h2>
            <div id="avisos" style="color: #ff5c5c;"></div>
            <div id="tabla-arr" class="rejilla">
                <h3>Por favor inicialice la estructura</h3>
            </div>
        </div>
    </div>
    
    <script src="../funciones/saveload.js"></script>
    <script>
        function handleSave() {
            const state = captureSearchState();
            // Capturar configuraciones espec칤ficas de hash doble
            const maxLoad = document.getElementById('i-max-load');
            const minLoad = document.getElementById('i-min-load');
            const autoReduce = document.getElementById('cb-auto-reduce');
            if (maxLoad) state.data.maxLoad = maxLoad.value;
            if (minLoad) state.data.minLoad = minLoad.value;
            if (autoReduce) state.data.autoReduce = autoReduce.checked;
            
            saveToFile(state, 'hash_doble', 'hash_doble.json');
            clearSimulation('search');
        }
        
        function handleLoad() {
            loadFromFile((data) => {
                // Restaurar configuraciones espec칤ficas antes del estado general
                if (data.data.maxLoad) {
                    const maxLoad = document.getElementById('i-max-load');
                    if (maxLoad) maxLoad.value = data.data.maxLoad;
                }
                if (data.data.minLoad) {
                    const minLoad = document.getElementById('i-min-load');
                    if (minLoad) minLoad.value = data.data.minLoad;
                }
                if (typeof data.data.autoReduce !== 'undefined') {
                    const autoReduce = document.getElementById('cb-auto-reduce');
                    if (autoReduce) autoReduce.checked = data.data.autoReduce;
                }
                
                restoreSearchState(data);
            });
        }
    </script>
</body>
</html>
